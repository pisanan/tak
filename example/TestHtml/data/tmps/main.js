{
	svrs:['data/services/empService.js'],
	state:'view',lder:{sn:"empSvr",fn:"getModel"},
	baseV:{type:"takView",loadingOn:"1",scene:["con","main"],
		subs:{
			tView:{type:"takView",scene:'title',
				subs:{
					logoV:{type:"ImgV",scene:"logo",val:"/example/config/images/logo.png"},
					mClose:{type:"Button",scene:"menuBtn",pro:{alias:"btn",icon:"icon-arrow-left"},jEven:"click",exts:{tip:'关闭/打开菜单'}},
					topV:{type:"takView",scene:"topTool"},
					userV:{type:"takView",scene:"topUser",
						subs:{
							user:{type:"BtnListV",scene:"topBtn",pro:{alias:"btn",icon:"icon-user"},
								subs:{
									cPwd:{type:"Button",val:'修改密码',scene:"menuBtn",pro:{alias:"btn",icon:"icon-note"},jEven:"click"},
									logOut:{type:"Button",val:'退出',scene:"menuBtn",pro:{alias:"btn",icon:"icon-logout"},jEven:"click"}
								}
							},
							logOut:{type:"Button",scene:"menuBtn",pro:{alias:"btn",icon:"icon-logout"},jEven:"click",exts:{tip:'退出'}}
						}
					}
				}
			},
			conV:{type:"takView",scene:["con","main-con"],
				subs:{
					mView:{type:"MenuV",loadingOn:"1"}
				}
			}
		},
		oMap:{def:"this.conV",tab:"this.tView.topV"}
	},
	subs:{
		conTab:{type:'tabCtrl',baseV:{type:"takView",scene:["con","listCtrl"]},
			conView:{type:"takView",loadingOn:"1",scene:"con"},
			tabTmp:{exts:{tip:'$setTip'},func:{
				setTip:function(f){
					this.bindEv('textChanged',function(s,v){
						f(v,s);
					});
				}
			}}
		}
	},
	exts:{
		eves:[{en:'loaded',func:'loaded'},{en:'valChanged',func:'valChanged'},
		{en:'click',func:'mCloseClick',on:'this.baseV.tView.mClose'},
		{en:'click',func:'logoutClick',on:'this.baseV.tView.userV.logOut'},
		{en:'doAction',func:'doAction',on:'this.baseV.conV.mView'},
		{en:'showCtrled',func:'showCtrled',on:'this.conTab'},
		{en:'hideCtrled',func:'hideCtrled',on:'this.conTab'},
		{en:'beginLoadData',func:'beginLoadData'},{en:'endLoadData',func:'endLoadData'}]
	},
	func:{
		loaded:function(){
			this.loadData("menu.json");
			this.$conTab.setTabBar(this.baseV.$tView.$topV);
		},
		doAction:function(s,n){
			var m=n.val();
			if(tak.iObj(m)&&m.ctrl){
				m.mv=n;
				this.$conTab.addCtrl(m);
			}
		},
		hideCtrled:function(s,c){
			if(tak.iObj(c)&&tak.ckTN(c.mv,MenuV))c.mv.active=false;
		},
		showCtrled:function(s,c){
			if(tak.iObj(c)&&tak.ckTN(c.mv,MenuV))c.mv.active=true;
		},
		loadParam:function(){
			return "menu.json";
		},
		valChanged:function(){
			var v=this.val();
			this.baseV.$conV.$mView.val(v.menu);
			this.baseV.$tView.$userV.$user.val(v.user.name);
		},
		mCloseClick:function(){
			var nos=!this.baseV.$conV.$mView.openState;
			this.baseV.$conV.$mView.openState=nos;
			this.baseV.$tView.$logoV.visible=nos;
			if(nos)this.baseV.$tView.$mClose.setIconVal('icon-arrow-left');
			else this.baseV.$tView.$mClose.setIconVal('icon-arrow-right');
		},
		beginLoadData:function(){
			this.baseV.$conV.visible=false;
			$.takApp.loading(null,'正在加载数据...',false);
		},
		endLoadData:function(){
			$.takApp.loaded();
			this.baseV.$conV.visible=true;
		}
	}
}
/**
 * tab页控制器
 * *///标签和值视图
/**
 * 视图容器控件
 * *///标签和值视图
//按钮视图
//多选按钮控件
/**
 * 多级控件
 * */
function tabCtrl(){}defCls(tabCtrl,listCtrl,{onCrtPro:function(a){listCtrl.prototype.onCrtPro.call(this,a);this.tabTmp={type:"TabBtnV",jEven:"click"}},onInit:function(a){listCtrl.prototype.onInit.call(this,a);tak.iObj(a.tabTmp)&&(this.tabTmp=tak.unTmp(this.tabTmp,a.tabTmp));tak.hStr(a.tabBar)&&this.setTabBar(a.tabBar)},setTabBar:function(a){tak.hStr(a)?this.findChild(a,this.setTabBarV,this):tak.ckTN(a,takView)?this.setTabBarV(a):tak.iObj(a)&&(a=this.newObj(a),tak.ckTN(a,takView)&&(this.addObj(a),this.setTabBarV(a)))},setTabBarV:function(a){0!=this.willBarChange(this.tabBar,a)&&(this.tabBar=a,this.barChanged(a),this.doEv("tabBarChanged"))},initCtrls:function(a){listCtrl.prototype.initCtrls.call(this,a);this.tabBar&&this.showTabs()},willBarChange:function(a,b){a&&this.eachCtrl(function(b){(b=a.findChild(b.id))&&b.dispose()},this)},barChanged:function(a){this.showTabs()},showTabs:function(){this.eachCtrl(function(a){this.addTab(a)},this)},crtCtrlOpt:function(a){var b=listCtrl.prototype.crtCtrlOpt.call(this,a);b.name=a.getName();b.icon=a.getPro("icon");return b},addTab:function(a){if(this.tabBar){var b=this.tabTmp;b.id=a.id;if(b=this.tabBar.addTObj(b))b.val(a),a.tabView=b,this.bindTabEv(b)}},bindTabEv:function(a){a.bindEv("click",function(a){this.openCtrl(a.id)},this);a.bindEv("closeClick",function(a){this.rmCtrl(a.id)},this)},activeTab:function(a){a.addJQClass("active")},closeTab:function(a){a.rmJQClass("active")},onAddOpted:function(a){this.addTab(a.tab?a.tab:a);listCtrl.prototype.onAddOpted.call(this,a)},onShowCtrled:function(a){listCtrl.prototype.onShowCtrled.call(this,a);a.tabView&&this.activeTab(a.tabView)},onHideCtrled:function(a){listCtrl.prototype.onHideCtrled.call(this,a);a.tabView&&this.closeTab(a.tabView)},onRmCtrled:function(a){listCtrl.prototype.onRmCtrled.call(this,a);a.tabView&&(a.tabView.dispose(),delete a.tabView)},openOpt:function(a){var b;tak.hStr(a.id)&&(b=this.openCtrl(a.id));b||(b=this.addOpt(a));return b}});function FieldV(){}defCls(FieldV,takView,{getIptJId:function(){return"name"},onRended:function(){takView.prototype.onRended.call(this);this.setFName(this.getPro("name"));this.setUName(this.getPro("un"))},setFName:function(a){this.getJQO("name",function(b){tak.hStr(a)?b.html(a+":"):b.html("")})},setUName:function(a){if(tak.hStr(a)){var b=this.getJQO("unit",function(b){b.html(a)});!b&&tak.hStr(a)&&this.baseJqo&&(b=this.crtJQO("span","unit"),this.baseJqo.append(b),b.html(a))}else this.rmJQO("unit")},create:function(){var a=this.crtJQO("div");this.fName=this.crtJQO("lable","name");a.append(this.fName);return a},getJqoCon:function(a){return this.getJQO("name")},appendView:function(a,b){b.baseJqo&&b.baseJqo.insertAfter(a)}});function btsPanel(){}defCls(btsPanel,takView,{onCrtPro:function(a){takView.prototype.onCrtPro.call(this,a);this.sct="md";this.autoRow=!0},onInit:function(a){takView.prototype.onInit.call(this,a);if(a=this.getPro("sct"))this.sct=a;if(a=this.getPro("autoRow"))this.autoRow="1"==a},getCellLenght:function(a){a=a.getPro("cl");if(!tak.iNum(a)||12<a||0>=a)a=6;return a},getRowView:function(a,b){this.rowVs||(this.rowVs=[]);if(0<this.rowVs.length&&12>a){var c=0;for(this.autoRow||(c=this.rowVs.length-1);c<this.rowVs.length;c++)if(12>=this.rowVs[c].cv+a)return this.rowVs[c]}var c="row"+(this.rowVs.length+1).toString(),d;b||(d=this.crtJQO("div",c,"row"),this.baseJqo.append(d));d={rv:d,cv:0,subs:[],name:c};this.rowVs.push(d);return d},onRmSubed:function(a){takView.prototype.onRmSubed.call(this,a);if(this.rowVs)for(var b,c=0;c<this.rowVs.length;c++){b=this.rowVs[c];for(var d=0;d<b.subs.length;d++)if(b.subs[d].v==a){b.cv-=b.subs[d].c;b.subs.splice(d,1);break}if(0==b.subs.length){this.rmJQO(b.name);this.rowVs.splice(c,1);break}}},rendSub:function(a){var b=a.getPro("sct");tak.hStr(b)||(b=this.sct);var c=this.getCellLenght(a),d=this.getRowView(c,"1"==a.getPro("hFill"));d.subs.push({v:a,c:c});d.cv+=c;d.rv?(a.rend(d.rv),a.addJQClass("col-"+b+"-"+c.toString())):(a.rend(this.baseJqo),a.addJQClass("tak-col-fill"))}});function RangeV(){}defCls(RangeV,takView,{onRended:function(){takView.prototype.onRended.call(this);this.setAddName(this.getPro("an"))},onInit:function(a){takView.prototype.onInit.call(this,a);this.cPN="alias";tak.hStr(a.cPN)&&(this.cPN=a.cPN)},setAddName:function(a){this.getJQO("addon",function(b){tak.hStr(a)?b.html(a):b.html("")})},getJqoCon:function(a){return this.getJQO("addon")},appendView:function(a,b){if(b.baseJqo){var c=b.getPro(this.cPN);"start"==c?b.baseJqo.insertBefore(a):"end"==c&&b.baseJqo.insertAfter(a)}},create:function(){var a=this.crtJQO("div");a.append(this.crtJQO("span","addon"));return a}});function ImgV(){}defCls(ImgV,takView,{getHVal:function(){return this.url},setHVal:function(a){this.url=a;if(tak.hStr(a))if(this.loadingOn){var b=new Image;this.showLoading();var c=this;b.onload=function(){c.rended&&c.url==a&&c.createImg()};b.src=a}else this.createImg();else this.rmJQO("imgv")},createImg:function(){if(!this.getJQO("imgv",this.serImgUrl,this)){var a=this.crtJQO("img","imgv");this.baseJqo.append(a);this.serImgUrl(a)}},serImgUrl:function(a){a.attr("src",this.url);this.loadingOn&&this.hideLoading()},create:function(){return this.crtJQO("div")}});function InputV(){}defCls(InputV,takView,{getInputAtt:function(){return{type:"text"}},genInput:function(){return this.crtJQO("input",this.getIptJId(),this.getInputAtt())},create:function(){return this.genInput()}});function TextV(){}defCls(TextV,InputV,{getType:function(){return"text"},getInputAtt:function(){var a={type:this.getType()},b=this.getPro("maxL");if(!tak.iNum(b)||0>=b||100<b)b=100;a.maxLength=b;b=this.getPro("placeholder");tak.hStr(b)&&(a.placeholder=b);return a},create:function(){var a=InputV.prototype.create.call(this),b=this.getPro("maskAlias");tak.hStr(b)&&tak.iFun(a.inputmask)&&(a.attr("data-inputmask","'alias': '"+b+"'"),a.inputmask());return a}});function PwdV(){}defCls(PwdV,TextV,{getType:function(){return"password"}});function TextArea(){}defCls(TextArea,takView,{getHtmlAtt:function(){var a={},b=this.getPro("rows");if(!tak.iNum(b)||0>=b||50<b)b=2;a.rows=b;b=this.getPro("maxL");if(!tak.iNum(b)||0>=b||100<b)b=100;a.maxLength=b;b=this.getPro("placeholder");tak.hStr(b)&&(b.placeholder=b);return a},create:function(){return this.crtJQO("textarea",this.getIptJId(),this.getHtmlAtt())}});function SelectV(){}defCls(SelectV,takView,{onCrtPro:function(a){takView.prototype.onCrtPro.call(this,a);this.items=[];this.rvp;this.rtp;this.autoSel=!0},onInit:function(a){takView.prototype.onInit.call(this,a);"0"==a.autoSel&&(this.autoSel=!1)},onCvtOptsChange:function(a){this.dCvt&&this.resetOpts(a,this.dCvt.valPn,this.dCvt.txtPn);takView.prototype.onCvtOptsChange.call(this,a)},onRended:function(){takView.prototype.onRended.call(this);var a=this.getCvtOpts();if(a)this.onCvtOptsChange(a)},selDef:function(){this.setJQVal("")},resetOpts:function(a,b,c){this.clearOpt();this.rvp=b;this.rtp=c;for(var d,e,g,f=0;f<a.length;f++)d=a[f],tak.iObj(d)||(e={},e[b]=d,d=e),tak.hStr(d[c])||(d[c]=d[b]),g="opt_"+f,(e=this.genOptV(d,"opt_"+f,b,c))&&this.items.push({id:f,view:e,jid:g,val:d[b],opt:d})},clearOpt:function(){if(this.items){for(var a=0;a<this.items.length;)this.rmJQO(this.items[a].jid),a++;this.items.splice(0,this.items.length)}},genOptV:function(a,b,c,d){var e=this.getJQO(this.getIptJId());if(e)return b=this.crtJQO("option",b,"opt",{value:a[c]}),b.html(a[d]),e.append(b),b},findItem:function(a){for(var b,c=0;c<this.items.length;c++)if(b=this.items[c],a(b))return b},findItems:function(a){for(var b,c=[],d=0;d<this.items.length;d++)b=this.items[d],a(b)&&c.push(b);return c},checkOpt:function(a,b){return tak.hStr(this.rvp)?tak.iObj(a)&&a[this.rvp]==b:!1},selOpt:function(a){if(tak.iObj(a))this.setVal(a[this.rvp]);else{var b=this.getHVal();if(b=this.findItem(function(a){return a.val==b}))return b.opt}},setJQVal:function(a,b){HtmlV.prototype.setJQVal.call(this,a,b)},getJQVal:function(a){return HtmlV.prototype.getJQVal.call(this,a)},getHVal:function(){return this.dCvt&&this.dCvt.loading?this.__val__:this.getJQVal()},setHVal:function(a){var b=!1,c;if(this.items)for(var d=0;d<this.items.length;d++)if(this.items[d].val==a){b=!0;break}else c||(c=this.items[d].val);!b&&this.autoSel&&(a=c);this.setJQVal(a,this.getIptJId())},create:function(){return this.crtJQO("select")}});function Button(){}defCls(Button,takView,{onCrtPro:function(a){takView.prototype.onCrtPro.call(this,a);this.tag="button";this.namePn="name";this.iconPn="icon"},onInit:function(a){takView.prototype.onInit.call(this,a);"a"==a.tag&&(this.tag="a");tak.hStr(a.namePn)&&(this.namePn=a.namePn);tak.hStr(a.iconPn)&&(this.iconPn=a.iconPn)},getIptJId:function(){return"txt"},addTxtTag:function(a){this.baseJqo.append(a)},addIconTag:function(a){this.baseJqo.prepend(a)},setTxtVal:function(a){if(tak.hStr(a)){var b=this.getJQO("txt",function(b){b.html(a)});b||(b=this.crtJQO("span","txt").html(a),this.addTxtTag(b))}else this.rmJQO("txt");this.doEv("textChanged",a)},setIconVal:function(a){if(tak.hStr(a)){var b=this.getJQO("icon",function(b){b.attr("class",a)});!b&&tak.hStr(a)&&(b=this.crtJQO("i","icon"),b.attr("class",a),this.addIconTag(b))}else this.rmJQO("icon")},setHVal:function(a){var b,c;tak.hStr(a)?(b=a,c=null):tak.iObj(a)&&(b=a[this.namePn],c=a[this.iconPn]);tak.hStr(b)&&this.setTxtVal(b);tak.hStr(c)||(c=this.getPro("icon"));this.setIconVal(c)},onRended:function(){var a=this.getName();tak.hStr(a)&&this.setTxtVal(a);takView.prototype.onRended.call(this);(a=this.val())||this.setIconVal(this.getPro("icon"))}});function TabBtnV(){}defCls(TabBtnV,Button,{onCrtPro:function(a){Button.prototype.onCrtPro.call(this,a);this.tag="div";this.closePn="close"},onInit:function(a){Button.prototype.onInit.call(this,a);this.tag="div";tak.hStr(a.closePn)&&(this.closePn=a.closePn)},addTxtTag:function(a){var b=this.getJQO("icon");b?a.insertAfter(b):(b=this.getJQO("btn"))&&b.append(a)},addIconTag:function(a){this.getJQO("btn",function(b){b.prepend(a)})},setHVal:function(a){Button.prototype.setHVal.call(this,a);tak.iObj(a)&&"0"==a[this.closePn]&&(this.rmJQO("cIcon"),this.rmJQO("close"))},create:function(){var a=this.crtJQO(this.tag),b=this.crtJQO("a","btn");a.append(b);var b=this.crtJQO("a","close"),c=this.crtJQO("i","cIcon");b.append(c);a.append(b);return a},onRended:function(){Button.prototype.onRended.call(this);this.bindJQEvF("click","close",function(a){this.doEv("closeClick")},this)}});function BtnListV(){}defCls(BtnListV,Button,{onCrtPro:function(a){Button.prototype.onCrtPro.call(this,a);this.subDef={type:"Button",tag:"a"};this.tag="div";this.btnTag="a";this.subLiId=0},addTxtTag:function(a){var b=this.getJQO("icon");b?a.insertAfter(b):(b=this.getJQO("arrow"))?a.insertBefore(b):(b=this.getJQO("btn"))&&b.append(a)},addIconTag:function(a){this.getJQO("btn",function(b){b.prepend(a)})},getConObj:function(a){return this},defEvenJqo:function(){return"btn;"},getDropUl:function(){var a=this.getJQO("dropUl");a||(a=this.crtJQO("ul","dropUl"),this.baseJqo.append(a));return a},getDropLi:function(a){if(this.btnCons){var b,c;for(c in this.btnCons)if(b=this.btnCons[c],b.view==a)return b}},crtDropLi:function(a){this.btnCons||(this.btnCons={});var b=this.getDropUl(),c="li_"+this.subLiId;this.subLiId++;var d=this.crtJQO("li",c,"dropLi");b.append(d);d={id:c,li:d,view:a};return this.btnCons[c]=d},checkArrow:function(){this.getJQO("arrow")||this.getJQO("btn",function(a){a.prepend(this.crtJQO("i","arrow"))})},rmArrow:function(){this.rmJQO("arrow")},create:function(){var a=this.crtJQO(this.tag),b=this.crtJQO(this.btnTag,"btn");a.append(b);return a},getJqoCon:function(a){var b=this.getDropLi(a);b||(b=this.crtDropLi(a));return b.li},rendSub:function(a){a&&a.rend(this);this.checkArrow()},onRmSubed:function(a){Button.prototype.onRmSubed.call(this,a);if(a=this.getDropLi(a))this.rmJQO(a.id),delete this.btnCons[a.id],this.subs&&0!=this.subs.length||this.rmArrow()}});function TitleV(){}defCls(TitleV,takView,{onCrtPro:function(a){takView.prototype.onCrtPro.call(this,a);this.defSubTmp={type:"Button"}},onRended:function(){takView.prototype.onRended.call(this);this.setIcon(this.getPro("icon"))},getHVal:function(){return this.getJQVal(this.getIptJId())},setHVal:function(a){this.setJQVal(a,this.getIptJId())},setTools:function(a){this.clearSubs();this.addSubs(a,!0)},setIcon:function(a){this.getJQO("icon",function(b){tak.hStr(a)?b.attr("class","fa "+ic):b.removeAttr("class")})},getIptJId:function(){return"subject"},getJqoCon:function(a){return this.getJQO("rBtns")},appendView:function(a,b){b.baseJqo&&a.prepend(b.baseJqo)},create:function(){var a=this.crtJQO("div"),b=this.crtJQO("div","caption"),c=this.crtJQO("i","icon"),d=this.crtJQO("span","subject"),e=this.crtJQO("div","rBtns");b.append(c);b.append(d);a.append(b);a.append(e);return a}});function MenuV(){}defCls(MenuV,TreeV,{onCrtPro:function(a){TreeV.prototype.onCrtPro.call(this,a);tak.genPro(this,"active",!1,this.activeChange);this.namePn="name";this.iconPn="icon"},onInit:function(a){TreeV.prototype.onInit.call(this,a);tak.hStr(a.namePn)&&(this.namePn=a.namePn);tak.hStr(a.iconPn)&&(this.iconPn=a.iconPn)},onRended:function(){TreeV.prototype.onRended.call(this);this.isRoot||this.bindJQEvF("click",this.getOpenTgtName(),function(){this.hasSubNode()?this.openState=!this.openState:this.active=!0},this);this.hasSubNode()&&this.getArrow()},activeChange:function(a,b){var c=tak.iBool(b)&&!this.isRoot;c&&(this.onActiveChange(b),this.getRoot().doEv("activeChanged",this));return c},onActiveChange:function(a){a?(this.getRoot().doEv("doAction",this),this.baseJqo.addClass("active"),tak.ckTN(this.parent,MenuV)&&(this.parent.active=!0)):(this.baseJqo.removeClass("active"),tak.ckTN(this.parent,MenuV)&&(this.parent.active=!1))},onOpenStateChange:function(a){TreeV.prototype.onOpenStateChange.call(this,a);if(a){var b=this.funBrother(function(a){if(a.openState)return!0});b&&(b.openState=!1)}this.hasSubNode()?a?this.setOpenAw(1):this.setOpenAw(-1):this.setOpenAw(0)},onNodeCountChange:function(){this.hasSubNode()?this.openState?this.setOpenAw(1):this.setOpenAw(-1):this.setOpenAw(0)},rendContent:function(a){var b=this.crtJQO("a","item");b.append(this.crtJQO("span","title"));var c=this.getJQO("subCon");c?b.insertBefore(c):a.append(b);return b},rendArrow:function(a){var b;this.getJQO("item",function(a){b=this.crtJQO("span","arrow");a.append(b)});return b},getViewCon:function(a){var b=this.getJQO("item");b||0==a||(b=this.rendContent(this.baseJqo));return b},getArrow:function(){var a=this.getJQO("arrow");a||(a=this.rendArrow());return a},getOpenTgtName:function(){return"item"},setRootVal:function(a){tak.iObj(a)&&(a=a[this.namePn],tak.hStr(a)&&(document.title=a))},setNodeVal:function(a){tak.iObj(a)&&(this.setIcon(a[this.iconPn]),this.setName(a[this.namePn]))},setIcon:function(a){var b=this.getJQO("icon");b?tak.hStr(a)?b.addClass(a):this.rmJQO("icon"):tak.hStr(a)&&this.getJQO("item",function(b){b.prepend(this.crtJQO("i","icon",{"class":a}))})},setName:function(a){this.setJQVal(a,"title")},setOpenAw:function(a){0!=a?this.getArrow():this.rmJQO("arrow")}});function FrameV(){}defCls(FrameV,takView,{onCrtPro:function(a){takView.prototype.onCrtPro.call(this,a);this.tag="iFrame"},getHVal:function(a){return this.baseJqo.attr("src")},setHVal:function(a){this.baseJqo.attr("src",a)}});function CheckBoxV(){}defCls(CheckBoxV,takView,{onCrtPro:function(a){takView.prototype.onCrtPro.call(this,a);this.checkState=!1},onRended:function(){takView.prototype.onRended.call(this);var a=this.getName();tak.hStr(a)&&this.setTxtVal(a);this.bindJQEvF("click","base",function(){this.getRealEnable()&&this.setVal(!this.checkState)},this)},setTxtVal:function(a){tak.hStr(a)?this.getJQO("txt",function(b){b.html(a)})||this.baseJqo.append(this.crtJQO("span","txt").html(a)):this.rmJQO("txt");this.doEv("textChanged",a)},checked:function(a){tak.iBool(a)&&this.checkState!=a&&(this.checkState=a,this.onCheckedChange(a));return this.checkState},onCheckedChange:function(a){this.baseJqo&&(a?this.baseJqo.addClass("checked"):this.baseJqo.removeClass("checked"))},getHVal:function(){return this.checked()},setHVal:function(a){this.checked(a)},create:function(){var a=this.crtJQO("lable"),b=this.crtJQO("span","icon");a.append(b);return a}});function chkListBox(){}defCls(chkListBox,SelectV,{onCrtPro:function(a){SelectV.prototype.onCrtPro.call(this,a);this.subDef={type:"CheckBoxV"};this.multi=!1},onInit:function(a){SelectV.prototype.onInit.call(this,a);"1"==a.multiSel&&(this.multi=!0)},clearOpt:function(){for(;0<this.items.length;)this.items[0].view.remove()},onRmSubed:function(a){SelectV.prototype.onRmSubed.call(this,a);for(var b=0;b<this.items.length;b++)if(this.items[b].view==a){this.items.splice(b,1);break}},subCheckedChange:function(a,b){if(!this.multi&&b)for(var c,d=0;d<this.items.length;d++)c=this.items[d],c.view!=a&&c.view.checked(!1);this.doHValChange(this.getHVal())},genOptV:function(a,b,c,d){if(a&&(a=this.addTObj({title:a[d]}),tak.ckTN(a,CheckBoxV)))return a.bindEv("hValChange",this.subCheckedChange,this),a},selOpts:function(){return this.findItems(function(a){a.view.checked()})},selOpt:function(){return this.findItem(function(a){a.view.checked()})},getHVal:function(){if(this.dCvt&&this.dCvt.loading)return this.__val__;if(this.multi){for(var a=this.selOpts(),b=[],c=0;c<a.length;c++)b.push(a[c].val);return b}if(a=this.selOpt())return a.val},setHVal:function(a){tak.iAry(a)||(a=[a]);for(var b,c=0;c<this.items.length;c++)b=this.items[c],0<=a.indexOf(b.val)?b.view.checked(!0):b.view.checked(!1)},selDef:function(){},create:function(){return this.crtJQO("div")}});function multLvV(){}defCls(multLvV,takView,{onCrtPro:function(a){takView.prototype.onCrtPro.call(this,a);this.subDef={type:"SelectV"}},onLoad:function(a){takView.prototype.onLoad.call(this,a);this.initSubView(tak.iNum(a.maxLv)&&1<a.maxLv?a.maxLv:3)},initSubView:function(a){if(this.dCvt){for(var b=[],c=0;c<a;c++)b.push(this.addTObj(this.subDef));this.items=b;this.dCvt.setItem(b)}},defCvtTmp:function(){return{type:"treeCvt"}},getHVal:function(){return this.items&&0<this.items.length?this.items[this.items.length-1].getHVal():this.__val__},setHVal:function(a){this.dCvt&&this.dCvt.setVal(a)}});